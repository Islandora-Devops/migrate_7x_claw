langcode: en
status: true
dependencies:
  enforced:
    module:
      - migrate_7x_claw
      - migrate_plus
      - islandora
id: islandora_basic_image_audit
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags: null
migration_group: islandora_7x
label: 'Basic Image Objects AUDIT'
source:
  plugin: islandora
  solr_base_url: 'http://192.168.0.120:8080/solr'
  fedora_base_url: 'http://192.168.0.120:8080/fedora'
  data_fetcher_plugin: http
  authentication:
    plugin: basic
    username: fedoraAdmin
    password: fedoraAdmin
  content_model_field: RELS_EXT_hasModel_uri_ms
  content_model: 'islandora:sp_basic_image'
  data_parser_plugin: audit_datastream
  item_selector: '/foxml:digitalObject'
  constants:
    creator_uid: 1
    image: Image
  fields:
    -
      name: PID
      label: PID
      selector: '@PID'
    -
  ids:
    PID:
      type: string
process:
  type:
    plugin: default_value
    default_value: image
  digital_id:
    plugin: str_replace
    source: PID_DSID
    search: ':'
    replace: _
  remote_path:
    plugin: concat
    delimiter: /
    source:
      - constants/fedora_base_url
      - constants/objects_string
      - PID
      - constants/datastreams_string
      - DSID
      - constants/content_string
  extension:
    plugin: static_map
    source: mimetype
    map:
      text/xml: xml
  filename:
    plugin: concat
    delimiter: .
    source:
      - '@digital_id'
      - '@extension'
  local_path:
    plugin: concat
    delimiter: /
    source:
      - constants/destination_directory
      - '@filename'
  uri:
    plugin: download
    source:
      - '@remote_path'
      - '@local_path'
    settings:
      authentication:
        plugin: basic
        username: fedoraAdmin
        password: fedoraAdmin
  uid: constants/creator_uid
destination:
  plugin: 'entity:file'
  default_bundle: image
migration_dependencies: null
